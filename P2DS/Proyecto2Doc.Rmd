---
title: "Entrega Final Proyecto 2 DataScience"
author: "Grupo 6"
date: "13 de noviembre de 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Resumen Ejecutivo
Scentia tiene una problemática que está afectando en sus números por lo tanto se debe de realizar una investigación, contar con un análisis de información para clasificarla e indagar áreas de oportunidad, conocer qué es lo que afecta actualmente a la empresa, los productos que menos rotan en cada país centroamericano, enlistar a los mejores vendedores de cada sector. Para ello se decidió determinar cada sector para poder conocer quienes son los que más o menos venden, uno de los puntos importantes para la empresa es conocer los productos que más devoluciones están obteniendo en cada país y los productos que no representan ventas para no enviar ese producto a ese país y enviarlo donde se vende mejor, así mismo conocer el comportamiento del mercado en cada país esto conlleva a recabar datos históricos sobre acontecimientos políticos, económicos y sociales.

#### Todo el codigo realizado puede ser consultado en el siguiente link a Github (Ubicación del código): https://github.com/josejo911/Proyecto2DS.git 


# Introducción 
Scentia es una empresa que se dedica a la comercialización de productos como perfumería, cuidado personal, maquillajes, productos de limpieza. Cuentan con operaciones en diferentes países a nivel centroamericano como Honduras, El Salvador, Nicaragua. Actualmente la empresa necesita conocer más puntos de vista para la optimización de la producción, logística y comercialización de sus productos en cada uno de los países que opera. Como objetivo general planteamos realizar un análisis exploratorio sobre las ventas por sector obtenidas en los países que se tienen operación mencionados anteriormente del año 2015 a 2019. Específicamente se decidió determinar cuales son los sectores que venden más y cuales son lo que venden menos en cada país, así mismo enlistar los productos que tienen más ventas y las que tienen menos ventas según los sectores que hayan resaltado en sus ventas totales además se analizó el comportamiento político, económico y social de los países centroamericanos mencionados anteriormente y por último se analizaron los productos que más devoluciones obtuvieron en cada año ya que representa un dato importante a la empresa por ser una pérdida de recursos. 

# Seleccion de algoritmos a utilizar
Machine Learning es un método de aprendizaje automático que automatiza la construcción de modelos analíticos. Se basa en máquinas de enseñanza a través de modelos de algoritmos.

Se puede dividir en tres modelos de aplicación:

* Aprendizaje supervisado
* Aprendizaje no supervisado
* Aprendizaje de refuerzo

Pasemos al caso clásico del hundimiento del Titanic . Con los modelos supervisados, es posible predecir qué pasajeros tienen más probabilidades de sobrevivir. El modelo se basa en algunas variables como clase, género, edad, número de hijos, etc.

Con el aprendizaje no supervisado, tenemos poca idea del resultado. En este contexto, utilizamos estructuras de datos que realmente no conocen el efecto de las variables.

El aprendizaje por refuerzo ya se basa en observar el contexto y seleccionar la mejor acción para esa situación. A cambio, el sistema recibe un premio, de lo contrario recibe una penalización. El aprendizaje por refuerzo busca la mejor estrategia de acuerdo con su política.

Algoritmos de aprendizaje
Existen varios algoritmos de Machine Learning pero debido a la estructura de la información que nos fue proporcionada y el objetivo general que nos expresó la empresa debemos mostrarles, es pequeña la cantidad de algoritmos que son de utilidad siendo algunos los siguientes: 

#### Regresión Lineal: 
Es la mejor manera de describir la relación entre dos variables. Su objetivo es dibujar un valor que no se puede estimar inicialmente. Es parte del aprendizaje supervisado. El objetivo de la regresión lineal es encontrar la ecuación que se ajuste a la mejor línea para modelar los datos.

#### Clustering: 
También conocido como análisis de conglomerados, consiste en agrupar cada punto del conjunto de datos en un grupo específico. Los datos agrupados comparten una similitud entre sí. La agrupación es un ejemplo de método de aprendizaje no supervisado.

#### Q-learning: 
Es el método más popular de aprendizaje por refuerzo. Le permite establecer una política de acción de forma interactiva y mostrar qué comportamiento tomar bajo ciertas circunstancias.

#### Series de Tiempo Temporales: 
Una serie temporal es un conjunto de muestras tomadas a intervalos de tiempo regulares. Es interesante analizar su comportamiento al mediano y largo plazo, intentando detectar patrones y poder hacer pronósticos de cómo será su comportamiento futuro. Lo que hace especial a una Time Series a diferencia de un problema de Regresión son dos cosas:

* Es dependiente del Tiempo. Esto rompe con el requerimiento que tiene la regresión lineal de que sus observaciones sean independientes.
Suelen tener algún tipo de estacionalidad, ó de tendencias a crecer ó decrecer. Pensemos en cuánto más producto vende una heladería en sólo 4 meses al año que en el resto de estaciones.

* Para el cumplimiento de nuestros objetivos se utilizaron finalmente dos algoritmos que fueron clustering y series de tiempo temporales. Debido a que uno de nuestros objetivos es saber el comportamiento de ventas generadas por los distintos sectores ubicados en los países centroamericanos, el uso de series de tiempo nos seria de gran utilidad para identificar algun patron de ventas a través de los años 2015 a 2019. El uso de clustering fue de gran ayuda al realizar el comportamiento de la data y en la toma de decisiones ya que al saber el comportamiento se podría empezar a plantear preguntas encontrando soluciones para los objetivos planteados.


Para realizar un mejor análisis se generó una matriz de correlación utilizando la data proporcionada para identificar las variables que están relacionadas y útiles para el análisis. Entre las variables de interés encontradas están:

### Variables de interés

* Ventas: Es una variable cuantitativa la cual será la clave para el análisis exploratorio.

* Mes y año de venta: Variable cuantitativa indispensable para la creación de ventas totales.

* Ventas totales: Variable cuantitativa que será utilizada para encontrar los sectores con más ventas por país y para encontrar las categorías con más ventas por sector.

* Distrito: Variable de carácter cualitativo dado que indica la pertenencia de una venta o un distrito asignado a un país. 

### Variables Respuesta
* Sectores que tienen mayor y menor cantidad de venta.

* Productos que más se venden y categorías que se venden menos. 

* Mujeres que más venden en Nicaragua.


# Modelos, Cálculos y Resultados

Dado que este conjunto de datos era nuevo, se enfocó más que todo en realizar un análisis exploratorio, en vez de determinar modelos de predicción que ayudarán a predecir la venta de estos. 


## Análisis exploratorio

### Librerías a usar
A continuación se llaman a todas los paquetes necesarios para poder llevar a cabo el análisis exploratorio.
```{r echo=FALSE, warning=FALSE, include=FALSE}
# Librerias a utilizar
require(ggpubr) # Para mejorar la visualización gráfica
require(tidyverse) # Para explotar, manipular y visualizar datos que comparten info
require(corrplot) # Para visualizar la matriz de correlación
require(cluster) #Para calcular la silueta
library(fpc) # Para hacer el plotcluster
library(NbClust) # Para determinar el numero de clusters optimo
library(factoextra) # Para hacer graficos bonitos de clustering
library(rela) # Para poder utilizar paf()
library(psych) # Para poder utilizar KMO()
library(corrplot)
library(REdaS)
library(ggplot2) # Graficas bonitas
#library(ggpubr) # Graficas bonitas x2
#library(ggmap)
library(arules) # Reglas de asociacion
library(factoextra) 
library(arulesViz)
library(dplyr)
#library(caret) # Muestreo estratificado
library(class) # Para KNN
library(e1071) # Requisito para la matriz de confusión
library(openxlsx)
library(plyr)
require(cluster) #Para calcular la silueta
library(fpc) # Para hacer el plotcluster
library(NbClust) # Para determinar el numero de clusters optimo
library(factoextra) # Para hacer graficos bonitos de clustering 
library(forcats)
library(cluster)
```


```{r echo=FALSE, warning=FALSE}
#"/Users/quiebres/Documents/Ivan Maldonado/UVG/SextoSemestre/Data Science/Proyecto2DS/P2DS"
# /Users/odalisrg/Documents/Semestre 6/Data Science/Proyecto2DS/P2DS
# F:/Data Science/Proyecto 2/Proyecto2DS
#C:/Users/Home/Documents/Tercer año/Sexto Semestre/Data Science/Proyecto2DS/P2DS

setwd("F:/Data Science/Proyecto 2/Proyecto2DS/P2DS")

# Leyendo el dataset de csv importacion
# Guatemala
SecG <- read.xlsx("USG1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)
DescG <- read.xlsx("USG1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)
# Leyendo el dataset de csv importacion
# Honduras
SecH <- read.xlsx("USH1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)
DescH <- read.xlsx("USH1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)
# Leyendo el dataset de csv importacion
# Nicaragua
SecN <- read.xlsx("USN1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)
DescN <- read.xlsx("USN1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)
# Leyendo el dataset de csv importacion
# El Salvador
SecS <- read.xlsx("USS1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)
DescS <- read.xlsx("USS1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)
```

Luego, se colocan ceros en las casillas que tienen NA ya que se analizará variables cuantitativas.
```{r}
SecG[is.na(SecG)] <- 0
SecH[is.na(SecH)] <- 0
SecN[is.na(SecN)] <- 0
SecS[is.na(SecS)] <- 0
```


## Modificación de columnas y filas
En esta parte, se creó una función que eliminara las primeras dos filas de todo el data set, ya que estas contenían el nombre de las columnas. Asimismo, se decidió dejar solamente cuatro columnas: Sector, Categoría, Producto y Ventas Finales. Todo lo demás se eliminó y se dejó solamente la información de todos los productos junto con sus categorías correspondientes. 

Sin embargo, se creó una nueva función que eliminara los sectores que no deben analizarse en este documento, tales como el sector AB y 0000, ya que son sectores de abogados y trabajadores. Asimismo, se elimina las categorías de Kimberly Clark, Descontinuados y Cuidado de uñas. 
```{r}
# -------------------------------
# Reduciendo el dataset
# -------------------------------
cambioTitulos <- function(x){
  names(x)[1] <- "Sector"
  names(x)[2] <- "Categoria"
  names(x)[3] <- "Producto"
  names(x)[length(x)] <- "VentasTotales"
  x <- x[-c(1, 2), ]
  x <- x[,c(1,2,3,length(x))]
}

# Modificaciones nuevas según Scentia
eliminarSectores <- function(x){
  x <- x[x$Sector != "0000", ]
  x <- x[x$Sector != "AB01", ]
  x <- x[x$Sector != "AB02", ]
  x <- x[x$Sector != "AB03", ]
}
# Elimina categorías
eliminarCat <- function(x){
  x <- x[x$Categoria != "KIMBERLY CLARK", ]
  x <- x[x$Categoria != "DESCONTINUADOS", ]
  x <- x[x$Categoria != "CUIDADO DE LAS UÑAS", ]
}


# -------------------------------
# Aplicación de las funciones
# -------------------------------
SecG <- cambioTitulos(SecG)
SecG <- eliminarSectores(SecG)
SecG <- eliminarCat(SecG)

SecG$VentasTotales <- as.numeric(SecG$VentasTotales)

SecS <- cambioTitulos(SecS)
SecS <- eliminarSectores(SecS)
SecS <- eliminarCat(SecS)

SecS$VentasTotales <- as.numeric(SecS$VentasTotales)

SecH <- cambioTitulos(SecH)
SecH <- eliminarSectores(SecH)
SecH <- eliminarCat(SecH)

SecH$VentasTotales <- as.numeric(SecH$VentasTotales)

SecN <- cambioTitulos(SecN)
SecN <- eliminarSectores(SecN)
SecN <- eliminarCat(SecN)

SecN$VentasTotales <- as.numeric(SecN$VentasTotales)


DescH <- DescH[-c(32,34),]
```

## Modificación a la hoja de descripción de sectores
Se dividió la descripción de cada sector a partir del símbolo "-" dejando dos filas. En la primera fila se econtraba el código del sector y en la segunda fila se encontraba la descripción del sector. Luego se le aplicó una transpuesta a estos data frame para obtener dos columnas. A partir de esto, se limpió el código de cada sector eliminando los espacios en blanco para poder ser utilizada en un futuro. Finalemnte se ordenaron los códigos de cada sector de menor a mayor.
```{r echo=FALSE}
#vector de sectores
## Guatemala
sectoresG <- strsplit(DescG[,c(2)], "-")
sectoresG <- data.frame(sectoresG)
sectoresG <- t(sectoresG[-c(2),])
sectoresG <- gsub(" ","", sectoresG)
sectoresG <- sort(sectoresG)

#Honduras
sectoresH <- strsplit(DescH[,c(2)], " - ")
sectoresH <- data.frame(sectoresH)
sectoresH <- t(sectoresH[-c(2),])
sectoresH <- gsub(" ","", sectoresH)
sectoresH <- sort(sectoresH)

## Nigaragua
sectoresN <- strsplit(DescN[,c(2)], "-")
sectoresN <- data.frame(sectoresN)
sectoresN <- t(sectoresN[-c(2),])
sectoresN <- gsub(" ","", sectoresN)
sectoresN <- sort(sectoresN)

## El Salvador
sectoresS <- strsplit(DescS[,c(2)], "-")
sectoresS <- data.frame(sectoresS)
sectoresS <- t(sectoresS[-c(2),])
sectoresS <- gsub(" ","", sectoresS)
sectoresS <- sort(sectoresS)
```

## Ventas totales de cada país
Se creó una función para sumar las ventas totales de cada producto de cada sector para obtener la venta total del sector en todo su periodo de tiempo. Después de esto, se graficaron las ventas totales de cada sector para cada país.
```{r}
crearLista <- function(x,y){
  lista <-c()
  for(i in seq(1, length(y), by=1)){
    sec <- subset(x, Sector == y[i])
    sec <- sec[,c(length(x))]
    lista[[i]] <- sum(as.numeric(sec))
  }
  return(lista)
}

# Guatemala
Guatemala <- as.data.frame(crearLista(SecG, sectoresG))
Guatemala$Sector <- sectoresG
names(Guatemala)[1] <- "VentasTotales"
Guatemala <- Guatemala[order(-Guatemala$VentasTotales),]
Guatemala %>%
  mutate(name = fct_reorder(Guatemala$Sector, desc(Guatemala$VentasTotales))) %>%
  ggplot( aes(x=name, y=Guatemala$VentasTotales)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    ylab("Ventas Totales por Sector") +
    xlab("Sector") +
    theme_bw()
```
Para el país de Guatemala se tiene que los sectores con más ventas son:

* CC (CLIENTES CONTADO - Distrito contado) con un total de 2840462 ventas por unidad

* 0021 (SANTA ROSA TODOS SUS MUNICIPIOS - Distrito Arius) con un total de 892428 ventas por unidad

* 0005 (CHIQUIMULA TODOS LOS MUNICIPIOS - Ditrito Sirius) con un total de 705007 ventas por unidad

* 0027 (JUTIAPA (CENTRO), MOYUTA, JALPATAGUA, JEREZ - Distrito Arius) con un total de 684809 ventas por unidad

* 0006 (ZACAPA TODOS LOS MUNICIPIOS - Distrito Sirius) con un total de 679730 ventas por unidad


Por otro lado, los sectores con menos ventas son:

* EX01 ( EXTERIOR - Distrito EXTERIOR) con un total de 0 ventas por unidad

* 0040 ( San Juan/San Pedro Sacatepequez - Distrito Orion) con un total de 2 ventas por unidad

* PR01 (PREMIOS POR RECOBRAR - Distrito Abogados) con un total de 12 ventas por unidad

* 0022 (TOTONICAPAN/QUETZALTENANGO - Distrito Orion) con un total de 190270 ventas por unidad

* 0042 (SECTOR 42 - Distrito Orion) con un total de 206768 ventas por unidad

## Top de roductos que más y menos venden según los sectores que más venden y total de 0 ventas por producto por sector

Se crea una función para separar los 0 de un sector para poder saber cuantos y cuales productos obtuvieron 0 en un sector.
```{r}
ceros <- function(x){
  prodCero <- subset(x, VentasTotales == "0")
  return(prodCero)
}
```


### Sector CC (CLIENTES CONTADO - Distrito contado)

Se tiene que en el sector de CC hay 84 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
gCC <- subset(SecG, Sector == "CC")
cerosgcc <- ceros(gCC)
cerosgcc
length(cerosgcc$VentasTotales)
```

Se observa que los primeros tres productos que más venden en este sector pertenecen a la categoría de USO DIARIO, siendo estos: 
* Fresh Fit Spray Antimicótico 200 con 86,852 ventas.
* Top Secret Roll-On Baby Powder 80G, con 80,357 ventas.
* Scentia Roll On Extreme Lady 80G, con 45,836 ventas. 
```{r}
gCC <- subset(gCC, VentasTotales != "0")
gCC <- gCC[order(gCC$VentasTotales, decreasing = TRUE),]
head(gCC,3)
```
Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de USO DIARIO, siendo estos: 
* Scentia perfume desodorante corporal apolo black 120 ml ofe2 con -120 ventas.
* Bolsa de recalo oct 2012 of con -127 ventas.
* Bolsa de regalo 2012 ofe 2 con -380 ventas.
```{r}
tail(gCC,3)
```


### Sector 0021 (SANTA ROSA TODOS SUS MUNICIPIOS - Distrito Arius)

Se tiene que en el sector de 0021 hay 53 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0021 <- subset(SecG, Sector == "0021")
cerosg0021 <- ceros(g0021)
cerosg0021
length(cerosg0021$VentasTotales)
```

Se observa que los primeros cuatros productos que más venden en este sector pertenecen a la categoría de USO DIARIO, siendo estos: 
* Fresh Fit Spray Antimicótico 200 con 17,392 ventas.
* Top Secret Roll-On Baby Powder 80G, con 16,557 ventas.
* Scentia Roll On Extreme Lady 80G, con 13,278 ventas. 
```{r}
g0021 <- subset(g0021, VentasTotales != "0")
g0021 <- g0021[order(g0021$VentasTotales, decreasing = TRUE),]
head(g0021,3)
```
Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de SALUD Y BIENESTAR, TEENS Y USO DIARIO, siendo estos: 
* Grazia eau de parfum 100Ml ofe, con -35 ventas.
* Torino apazote y manzanilla 100gr ofe, con -45 ventas.
* Bolsa de regalo blanca estucheria 2018 ellas ofe 8, con -48 ventas. 
```{r}
tail(g0021,3)
```



### Sector 0005 (CHIQUIMULA TODOS LOS MUNICIPIOS - Ditrito Sirius)

Se tiene que en el sector de 0005 hay 37 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0005 <- subset(SecG, Sector == "0005")
cerosg0005 <- ceros(g0005)
cerosg0005
length(cerosg0005$VentasTotales)
```

Se observa que los primeros productos que más venden en este sector pertenecen a la categoría de USO DIARIO y VISION FARMA, siendo estos: 
* Fresh Fit Spray Antimicótico 200 con 14,275 ventas.
* Top Secret Roll-On Baby Powder 80G, con 8,486 ventas.
* Scentia Roll On Extreme Lady 80G, con 8,452 ventas. 
```{r}

g0005 <- g0005[order(g0005$VentasTotales, decreasing = TRUE),]
head(g0005,3)
```
Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de SALUD Y BIENESTAR, siendo estos: 
* Catalogo suelto marzo gt 2019, con -26 ventas.
* Roll on extreme men + roll on active, con -34 venta.
* Catalogo suelto noviembre gt 2018 ofe, con -46 venta. 
```{r}
tail(g0005,3)
```

### Sector 0027 (JUTIAPA (CENTRO), MOYUTA, JALPATAGUA, JEREZ - Distrito Arius)

Se tiene que en el sector de 0027 hay 46 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0027 <- subset(SecG, Sector == "0027")
cerosg0027 <- ceros(g0027)
cerosg0027
length(cerosg0027$VentasTotales)
```

Se observa que los primeros productos que más venden en este sector pertenecen a la categoría de USO DIARIO y VISION FARMA, siendo estos: 
* Fresh Fit Spray Antimicótico 200 con 14,810 ventas.
* Rabano Yodado 240 ML, con 10,381 ventas.
* Top Secret Roll-On Baby Powder 80G, con 9,742 ventas.
```{r}
g0027 <- subset(SecG, Sector == "0027")
g0027 <- g0027[order(g0027$VentasTotales, decreasing = TRUE),]
head(g0027,3)
```
Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de USO DIARIO, siendo estos: 
* Sc fleurs des champs crema perfumada 320g. ofe, con -639 venta.
* Top famili sh 2 en 1 sabila nd 1lt resideño ofe 2, con -819 venta.
* Apolo black eau de cologne 100Ml ofe1, con -1002 venta. 
```{r}
tail(g0027,3)
```

### Sector 0006 (ZACAPA TODOS LOS MUNICIPIOS - Distrito Sirius)

Se tiene que en el sector de 0006 hay 49 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0006 <- subset(SecG, Sector == "0006")
cerosg0006 <- ceros(g0006)
cerosg0006
length(cerosg0006$VentasTotales)
```

Se observa que los primeros productos que más venden en este sector pertenecen a la categoría de USO DIARIO y VISION FARMA, siendo estos: 
* Top Secret Roll-On Baby Powder 80G, con 42,033 ventas. 
* Fresh Fit Spray Antimicótico 200 con 19,077 ventas.
* Scentia Roll On Extreme Lady 80G, con 17,910 ventas. 
```{r}
g0006 <- subset(SecG, Sector == "0006")
g0006 <- g0006[order(g0006$VentasTotales, decreasing = TRUE),]
head(g0006,3)
```
Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de USO DIARIO y TEENS, siendo estos: 
* Apolo black eau de cologne 100 ml ofe1, con -214 venta.
* Sc grazia eau de parfum 100 ml ofe 1, con -434 venta.
* Bolsa de bacha (Fuscia) tienda, con -1850 venta. 
```{r}
tail(g0006,3)
```

## Productos que más y menos venden según los sectores que menos venden

### Sector EX01 (EXTERIOR - Distrito EXTERIOR)
Este sector cuenta con 0 ventas
```{r echo = FALSE, warning = FALSE, include= FALSE}
gEX01 <- as.data.frame(subset(SecG, Sector == "EX01"))
gEX01 <- gEX01[order(gEX01$VentasTotales, decreasing = TRUE),]
head(gEX01, 3)
gEX01 <- gEX01[order(gEX01$VentasTotales, decreasing = FALSE),]
tail(gEX01, 3)
```

### Sector 0040 (San Juan/San Pedro Sacatepequez - Distrito Orion)
Este distrito cuenta con 4 prouctos donde solo un producto tiene ventas. Se observa que único producto con ventas pertenece a la categoría de LIMPIEZA, siendo este: 
* Clean House Desinfectante Pinabete Vainilla 1Gl, con 2 ventas.

Se observa que dos de los primeros tres productos que menos venden en este sector pertenecen a la categoría de USO DIARIO y el otro producto pertenece a la categoría de SALUD Y BIENESTAR, siendo estos: 
* Top Scret Fresh Concha Navar 80G, con 0 venta.
* Fresh Fit Spray Antimicótico 200, con 0 ventas.
* Hot Ice Unguento 80G, con 0 ventas.

```{r}
g040 <- as.data.frame(subset(SecG, Sector == "0040"))
g040 <- g040[order(g040$VentasTotales, decreasing = TRUE),]
head(g040, 3)
g040 <- g040[order(g040$VentasTotales, decreasing = FALSE),]
head(g040, 3)
```

### Sector PR01 (PREMIOS POR RECOBRAR - Distrito Abogados)

Se tiene que en el sector de PR01 hay 4 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
gPR01 <- subset(SecG, Sector == "PR01")
cerosgPR01 <- ceros(gPR01)
cerosgPR01
length(cerosgPR01$VentasTotales)
```

Se observa que el producto con más ventas pertenece a la categoría de Uso Diario mientras los otros dos pertenecen a la categoría de CUIDADO DE PIEL, siendo estos: 
* Top Secret Roll-On Baby Powder 80G, con 4 ventas.
* Clinical Sun Protector Solar 50FPS 60Gr, con 2 ventas.
* Crema de Concha Nacar con CIT E 150G, con 1 ventas.

Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de CUIDADO DE PIEL, DIVISION FARMA y MAQUILLAJE, respectivamente. Estos son: 
* Cobo Concha Nácar, con 0 ventas.
* Acetaminofen Adultos 20 Tabletas, con 0 ventas.
* Scentia Bella Color Luxury Nail Polish Silver, con 0 ventas.

```{r}
gPR01 <- as.data.frame(subset(SecG, Sector == "PR01"))
gPR01 <- gPR01[order(gPR01$VentasTotales, decreasing = TRUE),]
head(gPR01, 3)
gPR01 <- gPR01[order(gPR01$VentasTotales, decreasing = FALSE),]
head(gPR01, 3)
```

### Sector 0022 (TOTONICAPAN/QUETZALTENANGO - Distrito Orion)

Se tiene que en el sector de g0022 hay 37 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0022 <- subset(SecG, Sector == "0022")
cerosg0022 <- ceros(g0022)
cerosg0022
length(cerosg0022$VentasTotales)
```

Se observa que los productos con más ventas pertenecen a las categorías de USO DIARIO, CABELLO Y PROMOCIONALES VENDIDOS respectivamente, siendo estos: 
* Fresh Fit Sprey Antimicótico 200, con 2690 ventas.
* Top Fami Sh 2 en 1 Cola Caba Nd 1L, con 2371 ventas.
* Estuche Sc Fruits para Gel Antibac, con 1913 ventas.

Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de CABELLO respectivamente, siendo estos:
* Sc poema violet 100 ml ofe 1, con -36 ventas.
* Bolsa de regalo oct 2012 ofe 2, con -16 ventas.
* Bolsa de regalo oct 2012 ofe 1, con -7 ventas.

```{r}
g022 <- as.data.frame(subset(SecG, Sector == "0022"))
g022 <- g022[order(g022$VentasTotales, decreasing = TRUE),]
head(g022, 3)
g022 <- g022[order(g022$VentasTotales, decreasing = FALSE),]
head(g022, 3)
```

### Sector 0042 (SECTOR 42 - Distrito Orion)

Se tiene que en el sector de g0042 hay 31 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0042 <- subset(SecG, Sector == "0042")
cerosg0042 <- ceros(g0042)
cerosg0042
length(cerosg0042$VentasTotales)
```

Se observa que el producto con más ventas pertenece a la categoría de USO DIARIO y los otros dos productos pertenecen a la categoría de LIMPIEZA, siendo estos: 
* Fresh Fit Sprey Antimicótico 200, con 4221 ventas.
* Clean House Desinfectante Cereza 1Gl, con 2524 ventas.
* Clean House Desin. Manzana Canela 1Gl, con 2314 ventas.

Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de CABELLO respectivamente, siendo estos:
* Fresh fit spray antimicotico 200 ml ofe 1, con -33 ventas.
* Cepillo dental patito rosado, con -10 ventas.
* Audifonos scentia 2017 ofe 2. Ofe, con -7 ventas.

```{r}
g042 <- as.data.frame(subset(SecG, Sector == "0042"))
g042 <- g042[order(g042$VentasTotales, decreasing = TRUE),]
head(g042, 3)
g042 <- g042[order(g042$VentasTotales, decreasing = FALSE),]
head(g042, 3)
```

#### Sector 0038 (AN LUIS/POPTUN - Distrito Sirius)

Se tiene que en el sector de 0038 hay 70 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
g0038 <- subset(SecG, Sector == "0038")
cerosg0038 <- ceros(g0038)
cerosg0038
length(cerosg0038$VentasTotales)
```

Se observa que el producto con más ventas pertenece a la categoría de USO DIARIO, el segundo pertenece a la categoría de DIVISION FARMA y el tercer producto pertenece a la categoría de USO DIARIO, siendo estos: 
* Fresh Fit Sprey Antimicótico 200, con 5558 ventas.
* Rabano Yodado 240 Ml, con 4207 ventas.
* top Secret Roll-On Baby Powder 80G, con 3274 ventas.

Se observa que los primeros tres productos que menos venden en este sector pertenecen a la categoría de CABELLO respectivamente, siendo estos:
* Scentia perfume aromatizante ambiental apple cinamon ofe, con -6 ventas.
* Top family sh 2 en 1 nd chile 1 lt ofe, con -5 ventas.
* Top family sh 2 en 1 sabila nd 1lt ofe 1, con -4 ventas.

```{r}
g038 <- as.data.frame(subset(SecG, Sector == "0038"))
g038 <- g038[order(g038$VentasTotales, decreasing = TRUE),]
head(g038, 3)
g038 <- g038[order(g038$VentasTotales, decreasing = FALSE),]
head(g038, 3)
```




### Honduras
```{r}
# Honduras
Honduras <- as.data.frame(crearLista(SecH, sectoresH))
Honduras$Sector <- sectoresH
names(Honduras)[1] <- "VentasTotales"
Honduras <- Honduras[order(-Honduras$VentasTotales),]
Honduras %>%
  mutate(name = fct_reorder(Honduras$Sector, desc(Honduras$VentasTotales))) %>%
  ggplot( aes(x=name, y=Honduras$VentasTotales)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    ylab("Ventas Totales por Sector") +
    xlab("Sector") +
    theme_bw()
```
#### Sector 0321

Se tiene que en el sector de 0321 hay 32 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
H1 <- subset(SecH, Sector == "0321")
cerosH1 <- ceros(H1)
cerosH1
length(cerosH1$VentasTotales)
```

```{r}
H1 <- H1[order(H1$VentasTotales, decreasing = TRUE),]
head(H1,3)
```


#### Sector 0319

Se tiene que en el sector de 0319 hay 23 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
H2 <- subset(SecH, Sector == "0319")
cerosH2 <- ceros(H2)
cerosH2
length(cerosH2$VentasTotales)
```

```{r}
H2 <- H2[order(H2$VentasTotales, decreasing = TRUE),]
head(H2,3)
```

#### Sector 0304

Se tiene que en el sector de 0304 hay 47 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
H3 <- subset(SecH, Sector == "0304")
cerosH3 <- ceros(H3)
cerosH3
length(cerosH3$VentasTotales)
```

```{r}
H3 <- subset(SecH, Sector == "0304")
H3 <- H3[order(H3$VentasTotales, decreasing = TRUE),]
head(H3,3)
```

#### Sector 0308

Se tiene que en el sector de 0308 hay 35 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
H4 <- subset(SecH, Sector == "0308")
cerosH4 <- ceros(H4)
cerosH4
length(cerosH4$VentasTotales)
```

```{r}
H4 <- subset(SecH, Sector == "0308")
H4 <- H4[order(H4$VentasTotales, decreasing = TRUE),]
head(H4,3)
```

#### Sector 0335

Se tiene que en el sector de 0335 hay 40 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
H5 <- subset(SecH, Sector == "0335")
cerosH5 <- ceros(H5)
cerosH5
length(cerosH5$VentasTotales)
```

```{r}
H5 <- H5[order(H5$VentasTotales, decreasing = TRUE),]
head(H5,3)
```

```{r}
sH <- as.data.frame(subset(SecH, VentasTotales > "0"))
sH <- sH[order(sH$VentasTotales, decreasing = TRUE),]
tail(sH, 10)
```



```{r}
# Nicaragua
Nicaragua <- as.data.frame(crearLista(SecN, sectoresN))
Nicaragua$Sector <- sectoresN
names(Nicaragua)[1] <- "VentasTotales"
Nicaragua <- Nicaragua[order(-Nicaragua$VentasTotales),]
Nicaragua %>%
  mutate(name = fct_reorder(Nicaragua$Sector, desc(Nicaragua$VentasTotales))) %>%
  ggplot( aes(x=name, y=Nicaragua$VentasTotales)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    ylab("Ventas Totales por Sector") +
    xlab("Sector") +
    theme_bw()
```
Para el país de Nicaragua se tiene que los sectores con más ventas son:


* CC (SECTOR CONTADO - Distrito contado) con un total de 509950 ventas por unidad
* 0409 (RAQUEL UREY ESTRADA - Distrito Indiana Rivas) con un total de 307620 ventas por unidad
* 0402 (MARBELLY OBANDO RAMOS - Ditrito Indiana Rivas) con un total de 272197 ventas por unidad
* 0427 (MARÍA ISABEL MATUTE - Distrito Jannette Herrera) con un total de 271152 ventas por unidad
* 0405 (CLAUDIA HATYEL ALTAMIRANO RODRIGUEZ - Distrito Indiana Rivas) con un total de 262093 ventas por unidad
* 0407 (MILAGROS SUYEN RIVAS RIVAS - Distrito Indiana Rivas) con un total de 247739 ventas por unidad
* 0424 (JACQUELIN LEIVA -  Distrito Jannette Herrera) con un total de 241217 ventas por unidad
* 0404 (ROSA ADILIA OLIVAS - Distrito Indiana Rivas) con un total de 218165 ventas por unidad
* 0410 (KAREL FUENTES - Distrito Indiana Rivas) con un total de 214711 ventas por unidad

Por otro lado, los sectores con menos ventas son:

* 0412 ( RETAIL - Distrito Institucional) con un total de 79 ventas por unidad
* 0422 ( SECTOR CONTADO INSTITUCIONAL - Distrito Contado Institucional) con un total de 	301 ventas por unidad
* 0000 (LANCASCO - Distrito Empleado) con un total de 6061 ventas por unidad
* 0413 (SOBEYDA VARGAS - Distrito Indiana Rivas) con un total de 66970 ventas por unidad
* 0433 (VILMA RODRIGUEZ - Distrito Jannette Herrera) con un total de 94217 ventas por unidad
* 0408 (ARELYS CASTILLO - Distrito Indiana Rivas) con un total de 124018 ventas por unidad
* 0420 (KARLA ALVAREZ - Distrito Jannette Herrera) con un total de 140713 ventas por unidad
* 0426 (MAYELA DE LOS ANGELES GUTIERREZ GUEVARA - Distrito Jannette Herrera) con un total de 156187 ventas por unidad
* 0429 (JEANETH HERRERA - Distrito Jannette Herrera) con un total de 164861 ventas por unidad
* 0403 (JOHANNA MIRANDA - Distrito Indiana Rivas) con un total de 169754 ventas por unidad

Podemos observar que las tres mujeres que mas venden en Nicaragua son:
* Raquel  Urey Estrada
* Marbelly Obando Ramos
* María Isabel Matute

Además, las tres mujeres que menos venden en Nicaragua son:
* Sobeyda Vargas
* Vilma Rodríquez
* Arelys Castillo


### Sector Contado CC

Se tiene que en el sector de CC hay 35 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n1 <- as.data.frame(subset(SecN, Sector == "CC"))
cerosn1 <- ceros(n1)
cerosn1
length(cerosn1$VentasTotales)
```

```{r}
n1 <- as.data.frame(subset(SecN, Sector == "CC"))
n1 <- n1[order(n1$VentasTotales, decreasing = TRUE),]
head(n1, 3)
n1 <- as.data.frame(subset(SecN, VentasTotales > "0"))
n1 <- n1[order(n1$VentasTotales, decreasing = TRUE),]
tail(n1, 15)
```

### Sector  0409

Se tiene que en el sector de 0409 hay 45 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n2 <- as.data.frame(subset(SecN, Sector == "0409"))
cerosn2 <- ceros(n2)
cerosn2
length(cerosn2$VentasTotales)
```

```{r}
n2 <- as.data.frame(subset(SecN, Sector == "0409"))
n2 <- n2[order(n2$VentasTotales, decreasing = TRUE),]
head(n2, 3)
n2 <- as.data.frame(subset(SecN, VentasTotales > "0"))
n1 <- n1[order(n1$VentasTotales, decreasing = TRUE),]
tail(n1, 15)
```
### Sector  0402

Se tiene que en el sector de 0402 hay 40 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n3 <- as.data.frame(subset(SecN, Sector == "0402"))
cerosn3 <- ceros(n3)
cerosn3
length(cerosn3$VentasTotales)
```

```{r}
n3 <- as.data.frame(subset(SecN, Sector == "0402"))
n3 <- n3[order(n3$VentasTotales, decreasing = TRUE),]
head(n3, 3)
n03 <- n3[order(n3$VentasTotales, decreasing = FALSE),]
head(n03, 3)
```
### Sector  0427

Se tiene que en el sector de 0427 hay 29 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n4 <- as.data.frame(subset(SecN, Sector == "0427"))
cerosn4 <- ceros(n4)
cerosn4
length(cerosn4$VentasTotales)
```

```{r}
n4 <- as.data.frame(subset(SecN, Sector == "0427"))
n4 <- n4[order(n4$VentasTotales, decreasing = TRUE),]
head(n4, 3)
n04 <- n4[order(n4$VentasTotales, decreasing = FALSE),]
head(n04, 3)
```

### Sector  0405
Se tiene que en el sector de 0405 hay 56 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n5 <- as.data.frame(subset(SecN, Sector == "0405"))
cerosn5 <- ceros(n5)
cerosn5
length(cerosn5$VentasTotales)
```

```{r}
n5 <- as.data.frame(subset(SecN, Sector == "0405"))
n5 <- n5[order(n5$VentasTotales, decreasing = TRUE),]
head(n5, 3)
n05 <- n5[order(n5$VentasTotales, decreasing = FALSE),]
head(n05, 3)
```
## Sectores con menos ventas

### Sector 0412

Se tiene que en el sector de 0412 hay 1 producto con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n6 <- as.data.frame(subset(SecN, Sector == "0412"))
cerosn6 <- ceros(n6)
cerosn6
length(cerosn6$VentasTotales)
```

```{r}
n6 <- as.data.frame(subset(SecN, Sector == "0412"))
n6 <- n6[order(n6$VentasTotales, decreasing = TRUE),]
head(n6, 3)
n06 <- n6[order(n6$VentasTotales, decreasing = FALSE),]
head(n06, 3)
```

### Sector 0422

Se tiene que en el sector de 0422 hay 0 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n7 <- as.data.frame(subset(SecN, Sector == "0422"))
cerosn7 <- ceros(n7)
cerosn7
length(cerosn7$VentasTotales)
```

```{r}
n7 <- as.data.frame(subset(SecN, Sector == "0422"))
n7 <- n7[order(n7$VentasTotales, decreasing = TRUE),]
head(n7, 3)
n07 <- n7[order(n7$VentasTotales, decreasing = FALSE),]
head(n07, 3)
```

### Sector 0413

Se tiene que en el sector de 0413 hay 38 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n9 <- as.data.frame(subset(SecN, Sector == "0413"))
cerosn9 <- ceros(n9)
cerosn9
length(cerosn9$VentasTotales)
```

```{r}
n9 <- as.data.frame(subset(SecN, Sector == "0413"))
n9 <- n9[order(n9$VentasTotales, decreasing = TRUE),]
head(n9, 3)
n9 <- n9[order(n9$VentasTotales, decreasing = FALSE),]
head(n9, 3)
```
### Sector 0433

Se tiene que en el sector de 0433 hay 36 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
n10 <- as.data.frame(subset(SecN, Sector == "0433"))
cerosn10 <- ceros(n10)
cerosn10
length(cerosn10$VentasTotales)
```

```{r}
n10 <- as.data.frame(subset(SecN, Sector == "0433"))
n10 <- n10[order(n10$VentasTotales, decreasing = TRUE),]
head(n10, 3)
n10 <- n10[order(n10$VentasTotales, decreasing = FALSE),]
head(n10, 3)
```



## Análisis de El Salvador

```{r}
# El Salvador
Salvador <- as.data.frame(crearLista(SecS, sectoresS))
Salvador$Sector <- sectoresS
names(Salvador)[1] <- "VentasTotales"
Salvador <- Salvador[order(-Salvador$VentasTotales),]
Salvador %>%
  mutate(name = fct_reorder(Salvador$Sector, desc(Salvador$VentasTotales))) %>%
  ggplot( aes(x=name, y=Salvador$VentasTotales)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    ylab("Ventas Totales por Sector") +
    xlab("Sector") +
    theme_bw()

```
Para el país de El Salvador se tiene que los sectores con más ventas son:


* 0202 (SANTA ANA - Distrito Arius) con un total de 586658 ventas por unidad

* 0204 (SONSONATE - Distrito Arius) con un total de 347768 ventas por unidad

* CC (CONTADO - Ditrito Contado) con un total de 337734 ventas por unidad

* 0216 (USULUTAN - Distrito Sirius) con un total de 325733 ventas por unidad

* 0203 (CHALATENANGO - Distrito Arius) con un total de 301789 ventas por unidad

Por otro lado, los sectores con menos ventas son:


* 0214 (SUCHITOTO,COJUTEPEQUE, SAN RAFAEL CEDROS - Distrito Sirius) con un total de 	106909 ventas por unidad

* 0224 (CUSCATLAN - Distrito Sirius) con un total de 112256 ventas por unidad

* 0230 (SAN SALVADOR NORTE - Distrito Arius) con un total de 114430 ventas por unidad

* 0223 (USULUTAN NORTE - Distrito Sirius) con un total de 140411 ventas por unidad

* 0220 (LA UNION - Distrito Sirius) con un total de 142084 ventas por unidad

### Sectores con más ventas

##### Sector 0202
Se tiene que en el sector de 0202 hay 47 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
secS1 <- as.data.frame(subset(SecS, Sector == "0202"))
cerosS1 <- ceros(secS1)
cerosS1
length(cerosS1$VentasTotales)
```

```{r}
secS1<- secS1[order(secS1$VentasTotales, decreasing=TRUE),] 
secS1<- head(secS1, 3) #contiene los que mas se venden
secS01 <- secS1[order(secS1$VentasTotales, decreasing=FALSE),] 
secS01 <- head(secS01, 3) #contiene los que menos se venden
```

##### Sector 0204

Se tiene que en el sector de 0204 hay 48 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
secS2 <- as.data.frame(subset(SecS, Sector == "0204"))
cerosS2 <- ceros(secS2)
cerosS2
length(cerosS2$VentasTotales)
```

```{r}
secS2<- secS2[order(secS2$VentasTotales, decreasing=TRUE),] 
secS2<- head(secS2, 3)
secS02 <- secS2[order(secS2$VentasTotales, decreasing=FALSE),] 
secS02 <- head(secS02, 3) #contiene los que menos se venden
```

##### Sector 0203

Se tiene que en el sector de 0203 hay 52 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
secS3 <- as.data.frame(subset(SecS, Sector == "0203"))
cerosS3 <- ceros(secS3)
cerosS3
length(cerosS3$VentasTotales)
```

```{r}

secS3<- secS3[order(secS3$VentasTotales, decreasing=TRUE),] 
secS3<- head(secS3, 3)
secS03 <- secS3[order(secS3$VentasTotales, decreasing=FALSE),] 
secS03 <- head(secS03, 3) #contiene los que menos se venden
```

##### Sector 0212

Se tiene que en el sector de 0212 hay 59 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
secS4 <- as.data.frame(subset(SecS, Sector == "0212"))
cerosS4 <- ceros(secS4)
cerosS4
length(cerosS4$VentasTotales)
```

```{r}

secS4<- secS4[order(secS4$VentasTotales, decreasing=TRUE),] 
secS4<- head(secS4, 3)
secS04 <- secS4[order(secS4$VentasTotales, decreasing=FALSE),] 
secS04 <- head(secS04, 3) #contiene los que menos se venden
```

##### Sector 0210

Se tiene que en el sector de 0210 hay 62 productos con venta total igual a 0
```{r echo = FALSE, warning = FALSE, include= FALSE}
secS5 <- as.data.frame(subset(SecS, Sector == "0210"))
cerosS5 <- ceros(secS5)
cerosS5
length(cerosS5$VentasTotales)
```

```{r}
secS5 <- as.data.frame(subset(SecS, Sector == "0210"))
secS5<- secS5[order(secS5$VentasTotales, decreasing=TRUE),] 
secS5<- head(secS5, 3)
secS05 <- secS5[order(secS5$VentasTotales, decreasing=FALSE),] 
secS05 <- head(secS05, 3) #contiene los que menos se venden




masSalvador <-  c(secS1, secS2 , secS3, secS4, secS5)


```
### Sectores con menos ventas

* 0214 (SUCHITOTO,COJUTEPEQUE, SAN RAFAEL CEDROS - Distrito Sirius) con un total de 	106909 ventas por unidad
* 0224 (CUSCATLAN - Distrito Sirius) con un total de 112256 ventas por unidad
* 0230 (SAN SALVADOR NORTE - Distrito Arius) con un total de 114430 ventas por unidad
* 0223 (USULUTAN NORTE - Distrito Sirius) con un total de 140411 ventas por unidad
* 0220 (LA UNION - Distrito Sirius) con un total de 142084 ventas por unidad
* 0219 (MORAZAN - Distrito Sirius) con un total de 142319 ventas por unidad
* 0221 (ARMENIA - Distrito Arius) con un total de 150182 ventas por unidad
* 0213 (SOYAPANGO, ILOPANGO - Distrito Sirius) con un total de 160837 ventas por unidad
* 0208 (SAN MARCOS / NVO CUSCATLAN - Distrito Arius) con un total de 168747 ventas por unidad

##### Sector 0214
```{r}
secS6 <- as.data.frame(subset(SecS, Sector == "0214"))
secS6<- secS6[order(secS6$VentasTotales, decreasing=TRUE),] 
secS6<- head(secS6, 3) #contiene los que mas se venden
secS06 <- secS6[order(secS6$VentasTotales, decreasing=FALSE),] 
secS06 <- head(secS06, 3) #contiene los que menos se venden
```

##### Sector 0224
```{r}
secS7 <- as.data.frame(subset(SecS, Sector == "0224"))
secS7<- secS7[order(secS7$VentasTotales, decreasing=TRUE),] 
secS7<- head(secS7, 3) #contiene los que mas se venden
secS07 <- secS7[order(secS7$VentasTotales, decreasing=FALSE),] 
secS07 <- head(secS07, 3) #contiene los que menos se venden
```

##### Sector 0230
```{r}
secS8 <- as.data.frame(subset(SecS, Sector == "0230"))
secS8<- secS8[order(secS8$VentasTotales, decreasing=TRUE),] 
secS8<- head(secS8, 3) #contiene los que mas se venden
secS08 <- secS8[order(secS8$VentasTotales, decreasing=FALSE),] 
secS08 <- head(secS08, 3) #contiene los que menos se venden
```

##### Sector 0223
```{r}
secS9 <- as.data.frame(subset(SecS, Sector == "0223"))
secS9<- secS9[order(secS9$VentasTotales, decreasing=TRUE),] 
secS9<- head(secS9, 3) #contiene los que mas se venden
secS09 <- secS9[order(secS9$VentasTotales, decreasing=FALSE),] 
secS09 <- head(secS09, 3) #contiene los que menos se venden
```

##### Sector 0220
```{r}
secS10 <- as.data.frame(subset(SecS, Sector == "0220"))
secS10<- secS10[order(secS10$VentasTotales, decreasing=TRUE),] 
secS10<- head(secS10, 3) #contiene los que mas se venden
secS010 <- secS10[order(secS10$VentasTotales, decreasing=FALSE),] 
secS010 <- head(secS010,3)

```

## Top de productos de los sectores que más venden para El Salvador

### Sector 0202 (SANTA ANA - Distrito Arius)
Se observa que los primeros tres productos que más venden en este sector pertenecen a la categoría de USO DIARIO, siendo estos: 
* Fresh Fit Spray Antimicótico 200 con 86,852 ventas.

* Top Secret Roll-On Baby Powder 80G, con 80,357 ventas.

* Scentia Roll On Extreme Lady 80G, con 45,836 ventas. 

```{r}
s202 <- subset(SecS, Sector == "0202")
s202 <- s202[order(s202$VentasTotales, decreasing = TRUE),]
head(s202,3)
```

```{r}
sM <- as.data.frame(subset(SecS, VentasTotales > "0"))
sM <- sM[order(sM$VentasTotales, decreasing = TRUE),]
tail(sM, 10)
```

* 0214 (SUCHITOTO,COJUTEPEQUE, SAN RAFAEL CEDROS - Distrito Sirius) con un total de 	106909 ventas por unidad

* 0224 (CUSCATLAN - Distrito Sirius) con un total de 112256 ventas por unidad

* 0230 (SAN SALVADOR NORTE - Distrito Arius) con un total de 114430 ventas por unidad

* 0223 (USULUTAN NORTE - Distrito Sirius) con un total de 140411 ventas por unidad

* 0220 (LA UNION - Distrito Sirius) con un total de 142084 ventas por unidad
```{r}
S <- as.data.frame(subset(SecS, Sector == "0214"))
S <- S[order(S$VentasTotales, decreasing = TRUE),]
head(S, 3)
```
```{r}
S1 <- as.data.frame(subset(SecS, Sector == "0224"))
S1 <- S1[order(S1$VentasTotales, decreasing = TRUE),]
head(S1, 3)
```
```{r}
S2 <- as.data.frame(subset(SecS, Sector == "0230"))
S2 <- S2[order(S2$VentasTotales, decreasing = TRUE),]
head(S2, 3)
```
```{r}
S3 <- as.data.frame(subset(SecS, Sector == "0223"))
S3 <- S3[order(S3$VentasTotales, decreasing = TRUE),]
head(S3, 3)
```
```{r}
S4 <- as.data.frame(subset(SecS, Sector == "0220"))
S4 <- S4[order(S4$VentasTotales, decreasing = TRUE),]
head(S4, 3)
```


## Análisis de Honduras

```{r}
#Honduras
Honduras <- as.data.frame(crearLista(SecH, sectoresH))
Honduras$Sector <- sectoresH
names(Honduras)[1] <- "VentasTotales"
Honduras <- Honduras[order(-Honduras$VentasTotales),]
Honduras %>%
  mutate(name = fct_reorder(Honduras$Sector, desc(Honduras$VentasTotales))) %>%
  ggplot( aes(x=name, y=Honduras$VentasTotales)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    ylab("Ventas Totales por Sector") +
    xlab("Sector") +
    theme_bw()
```
## Analizando productos que tienen 0 venta:

### Guatemala 

```{r}
zeroG <- as.data.frame(subset(SecG, VentasTotales == "0"))
head(zeroG,10)

```

### El Salvador
```{r}
zeroS <- as.data.frame(subset(SecS, VentasTotales == "0"))
head(zeroS, 10)

```
### Honduras
```{r}
zeroH <- as.data.frame(subset(SecH, VentasTotales == "0"))
head(zeroH, 10)

```

### Nicaragua
```{r}
zeroN <- as.data.frame(subset(SecN, VentasTotales == "0"))
head(zeroN, 10)

```

## Análisis de devoluciones

### Guatemala
```{r}
dG <- as.data.frame(subset(SecG, VentasTotales < "0"))
dG$VentasTotales <- dG$VentasTotales*-1
dG <- dG[order(dG$VentasTotales, decreasing = TRUE),]
head(dG, 10)
```
# El Salvador
```{r}
dS <- as.data.frame(subset(SecS, VentasTotales < "0"))
tail(dS, 10)

```

# Honduras
```{r}
dH <- as.data.frame(subset(SecH, VentasTotales < "0"))
head(dH, 10)

```


# Nicaragua
```{r}
dN <- as.data.frame(subset(SecN, VentasTotales < "0"))
head(dN, 10)

```

## Clustering
Se decidió hacer un clustering para las ventas totales por sector de cada país, con el fin de agrupar los sectores entre ventas bajas, medias y altas. A continuación, se usó el agrupamiento por medio de las k-medias, usando un cálculo de 3 clusters por los rangos de ventas ya antes mencionados. 

### Clustering de Guatemala
Se observa que para el primer cluster, solo se encuentra el sector AB03 con 6,557,880 ventas unitarias; el segundo cluster se encuentra el sector CC con 2,840,462; el tercer cluster se encuentra el resto de sectores de Guatemala. Dado que en los primeros clusters solo se encuentra un sector, se llegó a la conclusión que para este data set, no trae cuenta agrupar estos sectores por medio de clustering, a pesar que la media de la Prueba de la Silueta dio como resultado 0.8675771. 
```{r}
# ClusterG <- Guatemala # Nuevo data frame únicamente para clusters
# km <- kmeans(Guatemala[,1],3) # Se calculan 3 clusters
# ClusterG$Grupo <- km$cluster # Se crea una nueva columna con el numero de cluster
# #Guatemala$Sector <- as.numeric(as.factor(Guatemala$Sector))
# 
# # Grafica de los clusters
# 
# fviz_cluster(km, data = Guatemala[,1:2], geom = "point", ellipse.type = "norm")
# 
# 
# # Prueba de la Silueta 
# silcluster <- silhouette(km$cluster, dist(Guatemala[,1]))
# mean(silcluster[,3]) # Media = 0.8675771. 
```

### Clustering de El Salvador
Se observa que para este país, el clustering tiene potencial para agrupar los sectores. Al momento de aplicarle un clustering con 3 k-medias, se obtuvo que la media de la prueba de silueta fue de 0.557041. Este resultado presenta que no es la mejor media esperada pero tampoco está mal. Al mundo de agrupar, se tuvo lo siguiente: 
* Primer grupo: En este grupo se encuentran los sectores que tienen ventas totales menores a 245,000.
* Segundo grupo: Se encuentran los sectores que tienen ventas totales entre $245,000 \leq ventas \leq 590,000$.
* Tercer grupo: Se encuentra el sector que tiene ventas totales mayores a 590,000. 
```{r}
# ClusterS <- Salvador # Nuevo data frame únicamente para clusters
# kmS <- kmeans(Salvador[,1],3) # Se calculan 3 clusters
# ClusterS$Grupo <- kmS$cluster # Se crea una nueva columna con el numero de cluster
# 
# # Grafica de los clusters
# 
# fviz_cluster(kmS, data = ClusterS[,1:3], geom = "point", ellipse.type = "norm")
# 
# 
# 
# # Prueba de la Silueta 
# silclusterS <- silhouette(kmS$cluster, dist(Salvador[,1]))
# mean(silclusterS[,3]) # Media = 0.8675771. 
```

### Clustering de Nicaragua
Nicaragua muestra un buen agrupamiento de ventas totales por medio de clustering, a pesar que la media de la prueba de silueta fue de 0.4045472. Este resultado no presenta un buen resultado acerca de qué tan alejados están los datos de cada cluster; sin embargo, se presenta el agrupamiento por ventas totales observados por el cluster:
* Primer grupo: En este grupo se encuentran los sectores que tienen ventas totales menores a 180,000.
* Segundo grupo: Se encuentran los sectores que tienen ventas totales entre $180,000 \leq ventas \leq 510,000$.
* Tercer grupo: Se encuentra el sector que tiene ventas totales mayores a 510,000. 
```{r}
# ClusterN <- Nicaragua # Nuevo data frame únicamente para clusters
# kmN <- kmeans(Nicaragua[,1],3) # Se calculan 3 clusters
# ClusterN$Grupo <- kmN$cluster # Se crea una nueva columna con el numero de cluster
# 
# # Grafica de los clusters
# 
# 
# 
# # Prueba de la Silueta 
# silclusterN <- silhouette(kmN$cluster, dist(Nicaragua[,1]))
# mean(silclusterN[,3]) # Media = 0.8675771. 
```


# Categorias que mas/menos venden
## Guatemala 
```{r}
SecG$VentasTotales <- as.numeric(SecG$VentasTotales) 
catG <- ddply(SecG, .(Categoria), summarize, sum=sum(VentasTotales))
catG<- catG[-c(1),] 
ggplot(data=catG, aes(x=Categoria, y=sum)) +
  geom_bar(stat="identity")+ coord_flip() 
```
Se tiene que las categorias que mas venden son: Uso diario, cabello y ellas. 
En cuanto a las que menos venden se tiene que: joyeria, cuidado personal y cuidado de las unas. 

## El Salvador

```{r}
SecS$VentasTotales <- as.numeric(SecS$VentasTotales) 
catS <- ddply(SecS, .(Categoria), summarize, sum=sum(VentasTotales))
catS<- catS[-c(1),] 
ggplot(data=catS, aes(x=Categoria, y=sum)) +
  geom_bar(stat="identity")+ coord_flip() 
```
Nuevamente, se tiene que entre las que mas venden son: uso diario, cabello y ellas. 
Entre las que menos venden se tienen: Joyeria, premios y paquetes.
## Nicaragua
```{r}
SecN$VentasTotales <- as.numeric(SecN$VentasTotales) 
catN <- ddply(SecN, .(Categoria), summarize, sum=sum(VentasTotales))
catN<- catN[-c(1),] 
ggplot(data=catN, aes(x=Categoria, y=sum)) +
  geom_bar(stat="identity")+ coord_flip() 
```
En este caso se tiene que las categorias que mas venden son: Uso diario, cabello, limpieza y ellas. 
Se observa que hay un incremento en las ventas de las categorias de limpieza y ellas. 
Por otro lado, para las que menos venden se tienen: Kimberly Clark, joyeria, descontinuados y cuidado de las unas. 

## Honduras
```{r}
SecH$VentasTotales <- as.numeric(SecH$VentasTotales) 
catH <- ddply(SecH, .(Categoria), summarize, sum=sum(VentasTotales))
catH<- catN[-c(1),] 
ggplot(data=catH, aes(x=Categoria, y=sum)) +
  geom_bar(stat="identity")+ coord_flip() 
```
Para el pais de Honduras, se observa que las categorias que mas venden son: Uso diario, limpieza, ellas y ninos. 
Asi tambien, las categorias que menos venden son: cuidado de las unas, descontinuados, joyeria y Kimberly Clark. 



# Discusión de resultados:

En vista a la poca cantidad de variables que se contaba para analizar el caso por sectores, se decidió que un clustering no era la opción más eficaz en este contexto; al momento de intentar agrupar aún más las variables a analizar, teníamos el riesgo de perder bastante información, por lo que se decidió trabajar con las que ya se tenían. Con respecto a las series de tiempo, se tenía una gran cantidad de sectores de cada país, por lo que se decidió realizar una serie de tiempo para los distritos únicamente. A pesar que el enfoque principal era analizar los productos que más y menos venden según los sectores y distritos, se concluyó que una serie de tiempo no puede representar el comportamiento de un conjunto de datos, ya que estos varían demasiado con respecto a otro, por lo que se recomienda hacer predicciones individuales de cada producto de cada país.

Por otro lado, se observó un comportamiento similar entre los sectores que más venden en Centroamérica según el top de productos que más venden. Dado esto, se puede generalizar los productos que más venden en los sectores que más venden de cada país; sin embargo, este comportamiento no se observa dentro de los sectores con menos ventas. Para este caso, se recomienda determinar los productos de interés en estos sectores y en base a ello, realizar un análisis más profundo para predecir si estos productos con bajas ventas llegarán a su límite de venta. 

Ahora, con respecto a los productos con cero ventas encontrados en cada sector, se recomienda realizar un análisis para poder decidir si es necesario continuar la distribución de estos productos en su respectivo sector. Por último, dado a la variabilidad de las ventas en cada sector, se recomienda la realización de un catálogo único por sector. Esto con el objetivo de que los productos con mayores ventas aparezcan con mayor continuidad y así poder aumentar las ganancias por sector.


# Conclusiones 

* La línea que más ventas tiene en los diferentes países es TOP FAMILY, se debe considerar para las proyecciones. 
* En Guatemala la categoría que menos vende es la de Cabello y el que más se vende es el Fresh Fit Spray Antimicótico 200. Sin embargo la categoría de Uso Diario contiene los productos que más se venden en todos los sectores, pero también contiene los que menos se venden.
* En El Salvador una de las categorías que más vendían eran cabello, uso diario pero engloban productos que tienen mayores y menores ventas
* En Honduras el producto que más se vende es el Clean House Desin. Manzana Canela 1G, además es un país que tiene pocas ventas en sus productos y la categoría que más ventas representa es la de Uso Diario. Se debe establecer un buen escenario para futuras proyecciones de lanzamientos de productos.
* En Nicaragua tiene la categoría de uso diario y salud bienestar que tiene los productos que más y menos ventas representan en todos los sectores. El producto que destaca es el Shampoo Cola de Caballo 2 en 1 y en comparación con el resto de países sus ventas no son tan bajas, pero se debe analizar sus futuros productos de lanzamiento.

# Bibliografía

* S.A (2018). *The R Graph Gallery*. Extraido de: https://www.r-graph-gallery.com/ [29/06/2019]

* D. (08/2019). *Markdown Text 101*. Extraido de: https://support.discordapp.com/hc/en-us/articles/210298617-Markdown-Text-101-Chat-Formatting-Bold-Italic-Underline- [06/10/2019]

* Theuwissen, M. (02/12/2015). *How to write the first for loop in R*. Extraido de: https://www.r-bloggers.com/how-to-write-the-first-for-loop-in-r/ [01/10/2019]

* Wickham, H. (2019). Advanced R. Chapman & Hall/CRC.

# Reflexión del proceso:

Al obtener el dataset por parte de Scentia, se procedió a limpiarlo, ordenarlo y analizarlo para ver qué variables se podrían tomar en cuenta para nuestro modelo. Inicialmente, se analizó solamente el archivo de “Paginación” a partir de él, se realizó un análisis exploratorio donde básicamente el objetivo fue determinar la relación entre las variables cualitativas y cuantitativas, el comportamiento de las variables cuantitativas. Resultó ser que este análisis no era el requerido por los ejecutivos de Scentia y se procedió a realizar el análisis de los archivos que contenían todas las ventas por sector de cada país e información pertinente a los distritos y sectores en los que se dividen las líneas de venta de Scentia.

Se procedió con analizar las ventas por sector, donde se le dio como prioridad a la identificación de sectores con mayor cantidad de ventas, así también de las categorías que más venden.  En cuanto a actividades de limpieza, se tiene que no se modificó a mayor escala el documento, en este punto se añadió un análisis por series de tiempo para cada uno de los distritos del país de Nicaragua como el primer acercamiento a un modelo de predicción. Se obtuvo que no era lo más útil a realizar en ese momento ya que se debía de explorar el conjunto de datos con mayor profundidad. En este punto del proyecto se tomó la decisión de que el proyecto se basaría en un análisis exploratorio meticuloso del conjunto de datos brindado ya que era algo que no se había explorado o analizado con anterioridad.  Se removieron las categorías de abogados, empleados y las categorías: “Kimberly Clark”, “descontinuados”, y “cuidado de las uñas”. También se hizo el hallazgo de que dado que los productos tienen bastante variabilidad de venta con respecto a las categorías, estos mismos debían de ser analizados 1 a 1, por sector ya que habían categorías que engloba productos que más vendían así como productos que no se vendían mucho dando lugar a que el valor promedio por venta de la categoría fuera bastante variable.
Finalmente, se añadió un análisis de las devoluciones por país, productos con 0 venta total, productos que vendan más y que venden menos en los diferentes sectores, se relacionó también el historial, político y económico con la variabilidad de las unidades vendidas por mes. 

Esta fue una experiencia bastante agradable y retadora para algunos de lo integrantes del grupo que carecía dominio y se tenía que poner a prueba todo lo aprendido en clase. Fue un trabajo que permitió desenvolver el conocimiento y aprender aún más acerca de las sugerencias que los directivos compartían, de este modo se podía entender mejor los datos y la forma de trabajar con ellos. Fue una experiencia que valió la pena, ya que fue el primer acercamiento hacia la vida real en el campo profesional, proporcionando una vista previa del trabajo de un analista de datos.  

