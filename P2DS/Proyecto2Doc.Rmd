---
title: "Proyecto 2 DataScience"
author: "Jose Javier Jo"
date: "28 de agosto de 2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Resumen de información
En los avances de proyecto 1, se había presentado el análisis exploratorio del archivo equivocado. Por ello, el primer paso fue realizar análisis exploratorio sobre los archivos que incluyen únicamente las ventas por sector, así como la distribución de cada sector. 
<<<<<<< HEAD
=======

>>>>>>> master
## Objetivos
* Separar las ventas por sectores.
* Crear una predicción sobre la ventas a partir de líneas de tiempo generadas con los datos que se tienen por sector de los últimos 4 años.
* Verificar la eficiencia del modelo comparando las gráficas de tiempo con la historia económica de los últimos 4 años.

## Variables de interés
* Ventas: es una variable cuantitativa la cual será clave para las predicciones.
* Mes y año de venta: variable cuantitativa indispensable para la creación de una serie de tiempo. 
* Sector: variable de carácter cualitativo dado que indica la pertenencia de una venta a un sector asignado en un país.

## Variables Respuesta
* Modelo de predicción a partir de la serie de tiempo. 

```{r echo=FALSE, warning=FALSE, include=FALSE}
# Librerias a utilizar
require(ggpubr) # Para mejorar la visualización gráfica
require(tidyverse) # Para explotar, manipular y visualizar datos que comparten info
require(corrplot) # Para visualizar la matriz de correlación
require(cluster) #Para calcular la silueta
library(fpc) # Para hacer el plotcluster
library(NbClust) # Para determinar el numero de clusters optimo
library(factoextra) # Para hacer graficos bonitos de clustering
library(rela) # Para poder utilizar paf()
library(psych) # Para poder utilizar KMO()
#library(FactoMineR)
library(corrplot)
library(REdaS)
library(ggplot2) # Graficas bonitas
#library(ggpubr) # Graficas bonitas x2
#library(ggmap)
library(arules) # Reglas de asociacion
library(factoextra) 
library(arulesViz)
library(dplyr)
#library(caret) # Muestreo estratificado
library(class) # Para KNN
library(e1071) # Requisito para la matriz de confusión
library(openxlsx)
```
```{r echo=FALSE}
#"/Users/quiebres/Documents/Ivan Maldonado/UVG/Sexto Semestre/Data Science/Proyecto2DS"
# /Users/odalisrg/Documents/Semestre 6/Data Science/Proyecto2DS/P2DS
# F:/Data Science/Proyecto 2/Proyecto2DS
setwd("/Users/quiebres/Documents/Ivan Maldonado/UVG/Sexto Semestre/Data Science/Proyecto2DS")

# Leyendo el dataset de csv importacion
# Honduras

SecG <- read.xlsx("USG1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)

DescG <- read.xlsx("USG1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)

# Leyendo el dataset de csv importacion
# Honduras

SecH <- read.xlsx("USH1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)

DescH <- read.xlsx("USH1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)

# Leyendo el dataset de csv importacion
# Nicaragua

SecN <- read.xlsx("USN1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)

DescN <- read.xlsx("USN1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)

# Leyendo el dataset de csv importacion
# El Salvador

SecS <- read.xlsx("USS1519.xlsx", sheet = 1, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "NA", fillMergedCells = FALSE)

DescS <- read.xlsx("USS1519.xlsx", sheet = 2, startRow = 1, colNames = TRUE,
                 rowNames = FALSE, detectDates = FALSE, skipEmptyRows = TRUE,
                 skipEmptyCols = TRUE, rows = NULL, cols = NULL, check.names = FALSE,
                 namedRegion = NULL, na.strings = "0", fillMergedCells = FALSE)

SecG[is.na(SecG)] <- 0
SecH[is.na(SecH)] <- 0
SecN[is.na(SecN)] <- 0
SecS[is.na(SecS)] <- 0
```

### Cambio de nombre a las columnas

```{r}
cambioTitulos <- function(x){

# -------------------------------
# Títulos principales
# -------------------------------
  names(x)[1] <- "Sector"
  names(x)[2] <- "Categoria"
  names(x)[3] <- "Producto y Descripcion"
  
  # -------------------------------
  # Año 2015
  # -------------------------------
  names(x)[4] <- "01-2015"
  names(x)[5] <- "02-2015"
  names(x)[6] <- "03-2015"
  names(x)[7] <- "04-2015"
  names(x)[8] <- "05-2015"
  names(x)[9] <- "06-2015"
  names(x)[10] <- "07-2015"
  names(x)[11] <- "08-2015"
  names(x)[12] <- "09-2015"
  names(x)[13] <- "10-2015"
  names(x)[14] <- "11-2015"
  names(x)[15] <- "12-2015"
  
  # -------------------------------
  # Año 2016
  # -------------------------------
  names(x)[16] <- "01-2016"
  names(x)[17] <- "02-2016"
  names(x)[18] <- "03-2016"
  names(x)[19] <- "04-2016"
  names(x)[20] <- "05-2016"
  names(x)[21] <- "06-2016"
  names(x)[22] <- "07-2016"
  names(x)[23] <- "08-2016"
  names(x)[24] <- "09-2016"
  names(x)[25] <- "10-2016"
  names(x)[26] <- "11-2016"
  names(x)[27] <- "12-2016"
  
  # -------------------------------
  # Año 2017
  # -------------------------------
  names(x)[28] <- "01-2017"
  names(x)[29] <- "02-2017"
  names(x)[30] <- "03-2017"
  names(x)[31] <- "04-2017"
  names(x)[32] <- "05-2017"
  names(x)[33] <- "06-2017"
  names(x)[34] <- "07-2017"
  names(x)[35] <- "08-2017"
  names(x)[36] <- "09-2017"
  names(x)[37] <- "10-2017"
  names(x)[38] <- "11-2017"
  names(x)[39] <- "12-2017"
  
  # -------------------------------
  # Año 2018
  # -------------------------------
  names(x)[40] <- "01-2018"
  names(x)[41] <- "02-2018"
  names(x)[42] <- "03-2018"
  names(x)[43] <- "04-2018"
  names(x)[44] <- "05-2018"
  names(x)[45] <- "06-2018"
  names(x)[46] <- "07-2018"
  names(x)[47] <- "08-2018"
  names(x)[48] <- "09-2018"
  names(x)[49] <- "10-2018"
  names(x)[50] <- "11-2018"
  
  # Se eliminan filas no útiles
  x <- x[-c(1, 2), ] 
}
SecG <- cambioTitulos(SecG)
SecH <- cambioTitulos(SecH)
SecN <- cambioTitulos(SecN)
SecS <- cambioTitulos(SecS)
```
<<<<<<< HEAD


```{r echo=FALSE}

#vector de sectores
sectoresG <- strsplit(DescG[,c(2)], "-")
sectoresG <- data.frame(sectoresG)
sectoresG <- t(sectoresG[-c(2),])

#lo de abjo no funciona
#plot.figure(figsize=(20,30))
i = 1
for sectores in sectoresG:
  data = SecG[SecG['Unidades'] == sectores]
  data = data.drop(['Unidades'], axis=1)
  data = data.astype(int).sum(axis=0)
  plt.subplot(7, 3, i)
  data.plot()
  plt.ylabel('Unidades')
  plt.title(category)
  i += 1
plt.show()

```



```{r echo=FALSE}


```


=======
>>>>>>> master
